function stopEvent(n){(n=window.event||n,n)&&(epoint.browser.isGecko&&(n.preventDefault(),n.stopPropagation()),n.cancelBubble=!0,n.returnValue=!1)}var HideScrollbar=!0,$bodyDimensions=function(n){n=n||window;var t=n.document,u=t.compatMode=="BackCompat"?t.body.clientWidth:t.documentElement.clientWidth,i=t.compatMode=="BackCompat"?t.body.clientHeight:t.documentElement.clientHeight,f=Math.max(t.documentElement.scrollLeft,t.body.scrollLeft),e=Math.max(t.documentElement.scrollTop,t.body.scrollTop),o=Math.max(t.documentElement.scrollWidth,t.body.scrollWidth),r=Math.max(t.documentElement.scrollHeight,t.body.scrollHeight);return r<i&&(r=i),{clientWidth:u,clientHeight:i,scrollLeft:f,scrollTop:e,scrollWidth:o,scrollHeight:r}},fadeEffect=function(n,t,i,r,u){n.effect||(n.effect={fade:0,move:0,size:0});clearInterval(n.effect.fade);var r=r||20;n.effect.fade=setInterval(function(){t=t<i?Math.min(t+r,i):Math.max(t-r,i);n.style.opacity=t/100;n.style.filter="alpha(opacity="+t+")";t==i&&(clearInterval(n.effect.fade),u&&u.call(n))},20)},topWin=window,topDoc=topWin.document,Dialog=function(){this.ID=null;this.Width=null;this.Height=null;this.URL=null;this.OnLoad=null;this.InnerHtml="";this.Top="50%";this.Left="50%";this.Title="　";this.OkButtonText="确 定";this.CancelButtonText="取 消";this.CallBack=null;this.OKEvent=null;this.CancelEvent=null;this.ShowButtonRow=!1;this.MessageIcon="window.gif";this.MessageTitle="";this.Message="";this.ShowMessageRow=!1;this.Modal=!0;this.Drag=!0;this.Resize=!0;this.AutoClose=null;this.ShowCloseButton=!0;this.ShowMinButton=!0;this.Animator=!epoint.browser.ielt7;this.MsgForESC="";this.InnerFrameName=null;this.IsMinDialog=!1;this.Params=null;this.DialogDiv=null;this.bgDiv=null;this.openerWindow=null;this.openerDialog=null;this.innerFrame=null;this.innerWin=null;this.innerDoc=null;this.zindex=900;this.cancelButton=null;this.okButton=null;this.unauthorized=!1;this.bodyLeft=0;this.bodyTop=0;this.bodyWidth=0;this.bodyHeight=0;this.eventX=0;this.eventY=0;this.startResize=!1;this.stopResize=!1;this.IsChart=!1;this.CurrentChatRoomID=null;arguments.length>0&&typeof arguments[0]=="string"?this.ID=arguments[0]:arguments.length>0&&typeof arguments[0]=="object"&&Dialog.setOptions(this,arguments[0]);this.ID||(this.ID=topWin.Dialog._dialogArray.length+"")};Dialog.IsRelatePop=!1;Dialog._dialogArray=[];Dialog._childDialogArray=[];Dialog._minDialogArray=[];Dialog.bgDiv=null;Dialog.setOptions=function(n,t){if(t)for(var i in t)n[i]=t[i]};Dialog.setLeftPosition=function(n){var u=this._minDialogArray,r,t,i;if(Dialog.IsRelatePop!=n)for(Dialog.IsRelatePop=n,r={left:"0"},t=0;t<u.length;t++)i=topWin.$("#_DialogDiv_"+u[t].ID),r.left=n?parseInt(i.css("left"))-346:parseInt(i.css("left"))+346,i.animate(r,500)};Dialog.prototype.MinDialog=function(){var u=topWin.$("#_DialogDiv_"+this.ID),r=Dialog.getInstance(this.ID),n=topWin.Dialog._minDialogArray,i={left:0,top:0},t;if(this.IsMinDialog==!1)n[n.length]={ID:this.ID,Top:r.Top,Left:r.Left,Width:r.Width,Height:r.Height},this.setSize(300,0,"IsMin"),i.top=document.body.clientHeight-44,i.left=document.body.clientWidth-326,u.animate(i,500),this.IsMinDialog=!0,topWin.$("#_DialogDiv_"+this.ID).find(".ui-dialog-titlebar-backtotab").show(),topWin.$("#_DialogDiv_"+this.ID).find(".ui-dialog-titlebar-min").hide();else{var f=0,e=0,o=0,s=0;for(t=0;t<n.length;t++)n[t].ID==this.ID&&(f=n[t].Top,e=n[t].Left,o=n[t].Width,s=n[t].Height,n.splice(t,1));this.setSize(o,s,"IsReCover");this.IsMinDialog=!1;topWin.$("#_DialogDiv_"+this.ID).find(".ui-dialog-titlebar-backtotab").hide();topWin.$("#_DialogDiv_"+this.ID).find(".ui-dialog-titlebar-min").show();u.animate({top:f,left:e},500,null,function(){for(var r,t=0;t<n.length;t++)r=topWin.$("#_DialogDiv_"+n[t].ID),i.top=document.body.clientHeight-44,i.left=document.body.clientWidth-226-212*t,r.animate(i,500)})}};Dialog.prototype.ResetZindex=function(){var n=Dialog._dialogArray;Dialog._dialogArray=n=epoint.array.sortBy(n,"zindex");var t=n[n.length-1],i=n[n.length-1].zindex,r=this.zindex;this.ID!=t.ID&&(this.SetZIndex(i),Dialog.getInstance(t.ID).SetZIndex(r))};Dialog.prototype.SetZIndex=function(n){this.DialogDiv.css("z-index",n);this.zindex=n};Dialog.prototype.attachBehaviors=function(){var n,i,t;this.Drag&&topWin.Drag&&(n=this.DialogDiv.children(".ui-dialog-titlebar")[0],topWin.Drag.init($bodyDimensions(topWin),n,this.DialogDiv[0]),n.onDragStart=function(){},n.onDragEnd=function(n,t){var i=Dialog.getInstance(self.ID);i.Left=n;i.Top=t});this.Resize&&(i=this,t=0,this.DialogDiv.resizable4epoint({handles:"e, s, w, se, sw",minWidth:50,onStartResize:function(n){var i=n.data;t=$(i.target).width();$(i.target).find("iframe").hide()},onResize:function(n){var r=n.data;return r.dir.indexOf("w")>-1&&($(r.target).css("left","-="+(r.width-t)),t=r.width),$(r.target).css({height:r.height-r.deltaHeight,width:r.width-r.deltaWidth}).children(".ui-dialog-content").css({height:r.height-i.paddHeight-r.deltaHeight}),!0},onStopResize:function(n){var t=n.data;$(t.target).children(".ui-dialog-content").children("IFRAME").show().css({height:t.height-i.paddHeight-t.deltaHeight})}}))};Dialog.prototype.displacePath=function(n){if(n.substr(0,7)=="http://"||n.substr(0,8)=="https://"||n.substr(0,1)=="/"||n.substr(0,11)=="javascript:")return n;for(var i=n,t=window.location.href,t=t.substring(0,t.lastIndexOf("/"));i.indexOf("../")>=0;)i=i.substring(3),t=t.substring(0,t.lastIndexOf("/"));return t+"/"+i};Dialog.prototype.setPosition=function(){var n=$bodyDimensions(topWin),u=this.Top,f=this.Left,r=this.DialogDiv[0],t,i;typeof this.Top=="string"&&this.Top.indexOf("%")!=-1&&(t=parseFloat(this.Top)*.01,u=epoint.browser.ielt7?n.clientHeight*t-r.scrollHeight*t+n.scrollTop:n.clientHeight*t-r.scrollHeight*t);typeof this.Left=="string"&&this.Left.indexOf("%")!=-1&&(i=parseFloat(this.Left)*.01,f=epoint.browser.ielt7?n.clientWidth*i-r.scrollWidth*i+n.scrollLeft:n.clientWidth*i-r.scrollWidth*i);u-=(parseInt(this.DialogDiv.css("border-top-width"))+parseInt(this.DialogDiv.css("border-bottom-width")))/2;f-=(parseInt(this.DialogDiv.css("border-left-width"))+parseInt(this.DialogDiv.css("border-right-width")))/2;this.DialogDiv.css({top:Math.round(u),left:Math.round(f)})};Dialog.setBgDivSize=function(){var n=$bodyDimensions(topWin);Dialog.bgDiv&&(epoint.browser.ielt10?(Dialog.bgDiv.style.height=n.clientHeight+"px",Dialog.bgDiv.style.top=n.scrollTop+"px",Dialog.bgDiv.childNodes[0].style.display="none",Dialog.bgDiv.childNodes[0].style.display=""):Dialog.bgDiv.style.height=n.scrollHeight+"px")};Dialog.resetPosition=function(){Dialog.setBgDivSize();for(var n=0,t=topWin.Dialog._dialogArray.length;n<t;n++)topWin.Dialog._dialogArray[n].setPosition()};Dialog.prototype._getHTML=function(){var n=['<div id="_Draghandle_{thisID}" class="ui-dialog-titlebar"><div class="ui-dialog-titleinner"><span class="ui-dialog-title">'];return n.push(this.Title),n.push('<\/span><span class="ui-button ui-dialog-titlebar-close" role="button" aria-disabled="false" title="关闭窗口"'+(this.ShowCloseButton?"":' style="display:none"')+'><\/span><\/div><\/div><div id="dialog" class="ui-dialog-content ui-widget-content" style="min-height: 103px; max-height: none; height: auto;">'),this.InnerHtml?n.push(this.InnerHtml):this.URL&&(n.push('<iframe width="100%" height="100%" frameborder="0" style="border:none 0;" id="_DialogFrame_'),n.push(this.ID+'" '+(this.InnerFrameName?'name="'+this.InnerFrameName+'"':"")),n.push(' src="'+this.displacePath(this.URL)+'"><\/iframe>')),n.push('<div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"'),n.push(this.ShowButtonRow?">":' style="display:none">'),n.push('<div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+this.OkButtonText+'<\/span><\/button><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+this.CancelButtonText+"<\/span><\/button><\/div><\/div><\/div>"),n};Dialog.prototype.create=function(){var i=$bodyDimensions(topWin),f,r,u,t,e,n;typeof this.OKEvent=="function"&&(this.ShowButtonRow=!0);this.Width||(this.Width=Math.round(i.clientWidth*4/10));this.Height||(this.Height=Math.round(this.Width/2));(this.MessageTitle||this.Message)&&(this.ShowMessageRow=!0);f=this.Width;r=this.Height;this.ButtonRowHeight=epoint.browser.ielt10?48:60;f>i.clientWidth&&(this.Width=Math.round(i.clientWidth-30));r>i.clientHeight&&(this.Height=Math.round(i.clientHeight-46-(this.ShowButtonRow?this.ButtonRowHeight:0)-(this.ShowMessageRow?50:0)));u=this.ID;t=topWin.$("#_DialogDiv_"+u);t.length==0&&(t=$("<DIV><\/DIV>").addClass("ui-dialog ui-front ui-draggable ui-resizable"+(this.ShowButtonRow?" ui-dialogInfo":"")).attr("id","_DialogDiv_"+u).css({position:"absolute",height:"auto",left:"-100px",top:"-100px",height:r,width:f}).html(this._getHTML().join("")).appendTo($(topWin.document.body)));e=epoint.browser.ielt10?parseInt(t.css("border-top-width"))+parseInt(t.css("border-bottom-width")):0;this.paddWidth=epoint.browser.ielt10?parseInt(t.css("border-left-width"))+parseInt(t.css("border-left-width")):0;this.paddHeight=this.ShowButtonRow?49:32;t.children(".ui-dialog-content").css({height:r-this.paddHeight}).children("IFrame").css({height:r-this.paddHeight});t.find(".ui-dialog-titlebar-close").click(function(n){Dialog.getInstance(u).cancelButton.click();n.stopImmediatePropagation()}).hover(function(){$(this).addClass("ButtonCloseOver")},function(){$(this).removeClass("ButtonCloseOver")});this.openerWindow=window;window.ownerDialog&&(this.openerDialog=window.ownerDialog);this.URL&&(topWin.document.getElementById("_DialogFrame_"+this.ID)&&(this.innerFrame=topWin.document.getElementById("_DialogFrame_"+this.ID)),n=this,this.innerFrameOnload=function(){if(n.innerFrame){n.innerWin=n.innerFrame.contentWindow;try{n.innerWin.ownerDialog=n;n.innerDoc=n.innerWin.document;n.Title=="　"&&n.innerDoc&&n.innerDoc.title&&n.innerDoc.title&&(topWin.document.getElementById("_Title_"+n.ID).innerHTML=n.innerDoc.title)}catch(t){window.console&&window.console.log&&console.log("可能存在访问限制，不能获取到浮动窗口中的文档对象。");n.unauthorized=!0}typeof n.OnLoad=="function"&&n.OnLoad()}},epoint.browser.isGecko?this.innerFrame.onload=n.innerFrameOnload:this.innerFrame.attachEvent("onreadystatechange",function(){try{/loaded|complete/.test(n.innerFrame.readyState)&&n.innerFrameOnload()}catch(t){}}));t[0].dialogId=this.ID;t[0].dialogInstance=this;this.DialogDiv=t;this.attachBehaviors();this.okButton=t.find(".ui-dialog-buttonset").children(":first");this.cancelButton=t.find(".ui-dialog-buttonset").children(":last");div=null};Dialog.prototype.createChatDialog=function(n){var f=$bodyDimensions(topWin),r=this.ID,i=topWin.$("#_DialogDiv_"+r),s,e,u,t,o;if(i.length==0)typeof this.OKEvent=="function"&&(this.ShowButtonRow=!0),this.Width||(this.Width=Math.round(f.clientWidth*4/10)),this.Height||(this.Height=Math.round(this.Width/2)),(this.MessageTitle||this.Message)&&(this.ShowMessageRow=!0),s=this.Width,e=this.Height,this.ButtonRowHeight=epoint.browser.ielt10?48:60,s>f.clientWidth&&(this.Width=Math.round(f.clientWidth-30)),e>f.clientHeight&&(this.Height=Math.round(f.clientHeight-46-(this.ShowButtonRow?this.ButtonRowHeight:0)-(this.ShowMessageRow?50:0))),u='<div id="_Draghandle_{thisID}" class="ui-dialog-titlebar ChatDialogTitle"><ul><li id="_li_{roomGuid}" class="active">'+n.TargetName+'<\/li><\/ul><div class="MinTitle"><\/div><div class="ui-dialog-titleinner"><span class="ui-button ui-dialog-titlebar-close" role="button" aria-disabled="false" title="关闭"><\/span><span class="ui-button ui-dialog-titlebar-min" role="button" aria-disabled="false" title="最小化"><\/span><span class="ui-button ui-dialog-titlebar-backtotab" role="button" aria-disabled="false" style="display:none;" title="还原"><\/span><\/div><\/div><div id="_Container_{roomGuid}" class="ui-dialog-content ui-widget-content" style="width: 100%;"><iframe width="100%" height="100%" frameborder="0" style="border:none 0;" id="_DialogFrame_'+this.ID+'" src="'+this.displacePath(n.Url)+'"><\/iframe><\/div>',u=u.replace(/\{thisID\}/gm,this.ID),u=u.replace(/\{roomGuid}/gm,n.RoomGuid),i=$("<DIV><\/DIV>").addClass("ui-dialog ui-front ui-draggable ui-resizable NoBorder"+(this.ShowButtonRow?" ui-dialogInfo":"")).attr("id","_DialogDiv_"+r).css({position:"absolute",height:"auto",left:"-100px",top:"-100px",height:e,width:s}).html(u).appendTo($(topWin.document.body)),this.paddWidth=epoint.browser.ielt10?parseInt(i.css("border-left-width"))+parseInt(i.css("border-left-width")):0,this.paddHeight=(this.ShowButtonRow?38:32)+(epoint.browser.ielt10?parseInt(i.css("border-top-width"))+parseInt(i.css("border-bottom-width")):0),i.children(".ui-dialog-content").css({height:e-this.paddHeight}).children("IFrame").css({height:e-this.paddHeight}),i.find(".ui-dialog-titlebar-close").click(function(){epoint.dialog.confirm("是否确认关闭所有聊天窗口？",function(){for(var t=Dialog.getInstance(r).DialogDiv.find("iframe"),i,n=0;n<t.length;n++)i=t[n].contentWindow.chatRoom,i.OutRoom();Dialog.getInstance(r).close()})}),i.find(".ui-dialog-titlebar-min").click(function(){Dialog.getInstance(r).MinDialog()}),i.find(".ui-dialog-titlebar-backtotab").click(function(){Dialog.getInstance(r).MinDialog()}),o=this.ID,$("#_li_"+n.RoomGuid).click(function(){$(this).hasClass("active")||($(this).parent().children().removeClass("active"),$(this).addClass("active"),$("#_DialogDiv_"+o).find(".ui-dialog-content").hide(),$("#"+this.id.replace("_li_","_Container_")).show())}),this.openerWindow=window,window.ownerDialog&&(this.openerDialog=window.ownerDialog),this.URL&&(topWin.document.getElementById("_DialogFrame_"+this.ID)&&(this.innerFrame=topWin.document.getElementById("_DialogFrame_"+this.ID)),t=this,this.innerFrameOnload=function(){if(t.innerFrame){t.innerWin=t.innerFrame.contentWindow;try{t.innerWin.ownerDialog=t;t.innerDoc=t.innerWin.document;t.Title=="　"&&t.innerDoc&&t.innerDoc.title&&t.innerDoc.title&&(topWin.document.getElementById("_Title_"+t.ID).innerHTML=t.innerDoc.title)}catch(n){window.console&&window.console.log&&console.log("可能存在访问限制，不能获取到浮动窗口中的文档对象。");t.unauthorized=!0}typeof t.OnLoad=="function"&&t.OnLoad()}},epoint.browser.isGecko?this.innerFrame.onload=t.innerFrameOnload:this.innerFrame.attachEvent("onreadystatechange",function(){try{/loaded|complete/.test(t.innerFrame.readyState)&&t.innerFrameOnload()}catch(n){}})),i[0].dialogId=this.ID,i[0].dialogInstance=this,this.DialogDiv=i,this.attachBehaviors(),this.okButton=i.find(".ui-dialog-buttonset").children(":first"),this.cancelButton=i.find(".ui-dialog-buttonset").children(":last");else if(this.IsMinDialog&&this.MinDialog(),$("#_li_"+n.RoomGuid).length>0){if($("#_li_"+n.RoomGuid).hasClass("active"))return;$("#_li_"+n.RoomGuid).click()}else o=this.ID,$("#_Draghandle_"+this.ID+">ul>.active").removeClass("active"),$('<li id="_li_'+n.RoomGuid+'" class="active">'+n.TargetName+"<\/li>").appendTo($("#_Draghandle_"+this.ID+">ul")).click(function(){$(this).parent().children().removeClass("active");$(this).addClass("active");$("#_DialogDiv_"+o).find(".ui-dialog-content").hide();$("#"+this.id.replace("_li_","_Container_")).show()}),$("#_DialogDiv_"+this.ID).children(".ui-dialog-content").hide(),$('<div id="_Container_'+n.RoomGuid+'" class="ui-dialog-content ui-widget-content" style="width: 100%;"><iframe width="100%" height="100%" frameborder="0" style="border:none 0;" id="_DialogFrame_'+n.RoomGuid+'" src="'+this.displacePath(n.Url)+'"><\/iframe><\/div>').appendTo("#_DialogDiv_"+this.ID),$("#_DialogFrame_"+n.RoomGuid).css({height:this.Height-this.paddHeight});i=null};Dialog.prototype.CloseChatRoom=function(n){if($("#_Container_"+n).length>0)if($("#_Draghandle_"+this.ID+">ul").children().length==1)this.close();else{var t=$("#_li_"+n).hasClass("active");$("#_li_"+n).remove();$("#_Container_"+n).remove();t&&$("#_Draghandle_"+this.ID+">ul").children().first().click()}};Dialog.prototype.setSize=function(n,t,i){if(n&&+n>20&&(this.Width=+n,$("#_DialogDiv_"+this.ID).css("width",this.Width)),t&&+t>10&&(this.Height=+t,$("#_DialogDiv_"+this.ID).css("height",this.Height)),i!=null&&i=="IsMin"){$("#_DialogDiv_"+this.ID).css("height",32);$("#_Draghandle_"+this.ID+">ul").hide();var r=$("#_Draghandle_"+this.ID+">ul>.active").html(),u=$("#_Draghandle_"+this.ID+">ul").children().length;u>1&&(r+="等"+u+"个会话");$("#_Draghandle_"+this.ID+">.MinTitle").html(r);this.CurrentChatRoomID=$("#_DialogDiv_"+this.ID).find(".ui-dialog-content:visible")[0].id;$("#_DialogDiv_"+this.ID).find(".ui-dialog-content").hide();$("#_DialogDiv_"+this.ID).find(".ui-dialog-content").css("height",0)}else this.IsChart?($("#_Draghandle_"+this.ID+">.MinTitle").html(""),$("#_DialogDiv_"+this.ID).find("#"+this.CurrentChatRoomID).show(),$("#_Draghandle_"+this.ID+">ul").show()):$("#_DialogDiv_"+this.ID).find(".ui-dialog-content").show(),$("#_DialogDiv_"+this.ID).find(".ui-dialog-content").css("height",this.Height-32)};Dialog.prototype.show=function(n){var i=Dialog.getBgdiv(),f=parseInt(Dialog.bgDiv.style.zIndex)+1,t,e,r,u;if(topWin.Dialog._dialogArray.length>0?f=this.getMaxZindex()+2:(i.style.display="none",HideScrollbar&&(t=topDoc.getElementsByTagName(topDoc.compatMode=="BackCompat"?"BODY":"HTML")[0],t.styleOverflow=t.style.overflow,window.navigator.userAgent.indexOf("Firefox/3.6")!=-1?(e=t.scrollTop,t.style.overflow="hidden",t.scrollTop=e):t.style.overflow="hidden")),this.Modal&&(i.style.zIndex=f-1,Dialog.setBgDivSize(),i.style.display=="none"&&(this.Animator?(r=topWin.document.getElementById("_DialogBGMask"),r.style.opacity=0,r.style.filter="alpha(opacity=0)",i.style.display="",fadeEffect(r,0,40,60),r=null):i.style.display="")),this.IsChart?this.createChatDialog(n):this.create(),this.IsChart&&(f=150),this.SetZIndex(f),topWin.Dialog._dialogArray.push(this),Dialog._childDialogArray.push(this),Dialog._childDialogArray.length==1&&window.ownerDialog&&ownerDialog.hiddenCloseButton(),u=this,this.setPosition(),this.CancelEvent&&(this.cancelButton.click(function(){u.CancelEvent.apply(u)}),this.ShowButtonRow))try{this.cancelButton.focus()}catch(o){}if(this.OKEvent&&(this.okButton.click(function(){u.OKEvent.apply(u)}),this.ShowButtonRow))try{this.okButton.focus()}catch(o){}this.AutoClose&&this.AutoClose>0&&this.autoClose();this.opened=!0;i=null};Dialog.prototype.getMaxZindex=function(){for(var t=900,n=topWin.Dialog._dialogArray.length-1;n>=0;n--)topWin.Dialog._dialogArray[n].Modal&&topWin.Dialog._dialogArray[n].zindex>t&&(t=topWin.Dialog._dialogArray[n].zindex);return t};Dialog.prototype.close=function(){var o,e,t,n,s,r,u,f,i;if(this.unauthorized!=!1||!this.innerWin||!this.innerWin.Dialog||!(this.innerWin.Dialog._childDialogArray.length>0)){if(this==topWin.Dialog._dialogArray[topWin.Dialog._dialogArray.length-1]?o=topWin.Dialog._dialogArray.pop():topWin.Dialog._dialogArray=epoint.array.remove(topWin.Dialog._dialogArray,this),Dialog._childDialogArray=epoint.array.remove(Dialog._childDialogArray,this),Dialog._childDialogArray.length==0&&window.ownerDialog&&ownerDialog.showCloseButton(),e=!0,topWin.Dialog._dialogArray.length>0&&this.Modal&&o)for(t=topWin.Dialog._dialogArray.length;t;)if(--t,topWin.Dialog._dialogArray[t].Modal){Dialog.bgDiv.style.zIndex=topWin.Dialog._dialogArray[t].zindex-1;e=!1;break}for(e&&(Dialog.bgDiv.style.zIndex="900",Dialog.bgDiv.style.display="none",HideScrollbar&&(n=topDoc.getElementsByTagName(topDoc.compatMode=="BackCompat"?"BODY":"HTML")[0],n.styleOverflow!=undefined&&(window.navigator.userAgent.indexOf("Firefox/3.6")!=-1?(s=n.scrollTop,n.style.overflow=n.styleOverflow,n.scrollTop=s):n.style.overflow=n.styleOverflow))),this.openerWindow.focus(),r=this.DialogDiv.find("iframe"),u=0;u<r.length;u++)epoint.iFrame.destroy($(r[u]));for(r=null,this.DialogDiv.remove(),this.innerFrame=null,this.bgDiv=null,this.closed=!0,f=topWin.Dialog._minDialogArray,i=0;i<f.length;i++)f[i].ID==this.ID&&f.splice(i,1);epoint.browser.ielt10&&CollectGarbage()}};Dialog.prototype.autoClose=function(){if(this.closed){clearTimeout(this._closeTimeoutId);return}if(this.AutoClose-=1,topWin.document.getElementById("_Title_"+this.ID).innerHTML=this.AutoClose+" 秒后自动关闭",this.AutoClose<=0)this.close();else{var n=this;this._closeTimeoutId=setTimeout(function(){n.autoClose()},1e3)}};Dialog.getInstance=function(n){var t=topWin.$("#_DialogDiv_"+n);if(t.length==0)return null;try{return t[0].dialogInstance}catch(i){return null}};Dialog.prototype.setTitle=function(n){parent.$("#_DialogDiv_"+this.ID).find(".ui-dialog-title").html(n)};Dialog.prototype.addButton=function(n,t,i){var r,u;return topWin.document.getElementById("_ButtonRow_"+this.ID).style.display="",this.ShowButtonRow=!0,r=topDoc.createElement("input"),r.id="_Button_"+this.ID+"_"+n,r.type="button",r.style.cssText="margin-right:5px",r.value=t,r.onclick=i,u=topWin.document.getElementById("_DialogButtons_"+this.ID).getElementsByTagName("INPUT")[0],u.parentNode.insertBefore(r,u),r};Dialog.prototype.removeButton=function(){$("#_DialogButtons_"+this.ID).find("INPUT:first").remove()};Dialog.prototype.hiddenCloseButton=function(){topWin.$("#_DialogDiv_"+this.ID+" .ButtonClose").hide()};Dialog.prototype.showCloseButton=function(){topWin.$("#_DialogDiv_"+this.ID+" .ButtonClose").show()};Dialog.getBgdiv=function(){var n,t;if(Dialog.bgDiv)return Dialog.bgDiv;if(n=topWin.document.getElementById("_DialogBGDiv"),!n){n=topDoc.createElement("div");n.id="_DialogBGDiv";n.style.cssText="position:absolute;left:0px;top:0px;width:100%;height:100%;z-index:900";n.innerHTML='<div style="position:relative;width:100%;height:100%;"><div id="_DialogBGMask" style="position:absolute;background-color:#333;opacity:0.4;filter:alpha(opacity=40);width:100%;height:100%;"><\/div><iframe src="about:blank" style="filter:alpha(opacity=0);opacity:0" width="100%" height="100%"><\/iframe><\/div>';topDoc.getElementsByTagName("BODY")[0].appendChild(n);t=n.getElementsByTagName("IFRAME")[0].contentWindow.document;t.open();t.write("<body style='background-color:#333' oncontextmenu='return false;'><\/body>");t.close();t=null}return Dialog.bgDiv=n,n=null,Dialog.bgDiv};Dialog.onKeyDown=function(n){var n=window.event||n,t;if((n.shiftKey&&n.keyCode==9||n.keyCode==8)&&topWin.Dialog._dialogArray.length>0&&(t=n.srcElement||n.target,t.tagName!="INPUT"&&t.tagName!="TEXTAREA"))return stopEvent(n),!1;n.keyCode==27&&Dialog.close()};Dialog.close=function(){if(topWin.Dialog._dialogArray.length>0){var n=topWin.Dialog._dialogArray[topWin.Dialog._dialogArray.length-1];n.MsgForESC?Dialog.confirm(n.MsgForESC,function(){n.cancelButton.onclick.apply(n.cancelButton,[])}):n.cancelButton.onclick.apply(n.cancelButton,[])}};Dialog.showInfo=function(n,t,i,r,u,f,e,o){var u=u||560,f=f||250,s=new Dialog({Width:u,Height:f,Params:r,Resize:!1}),h;s.ShowMinButton=!1;s.ShowCloseButton=!1;s.ShowButtonRow=e!==!1;s.Animator=o!==!1;switch(n){case"info":s.Title="系统提示";break;case"errinfo":s.Title="错误信息";break;case"warninfo":s.Title="警告信息";break;default:s.Title="执行成功"}s.CancelEvent=function(){s.close();i&&i(s.Params)};s.InnerHtml='<div class="icon '+n+'"><\/div><div class="message">'+t+"<\/div>";s.Top=($(document.body).height()-f)/2+$(document).scrollTop();s.Left=($(document.body).width()-u)/2+$(document).scrollLeft();s.show();h=s.DialogDiv.find(".message");h.css("top",(120-h.height())/2);s.okButton.hide().parent().css("textalign","center");s.cancelButton.children().html(s.OkButtonText);try{s.cancelButton.focus()}catch(c){}return s};epoint.dialog.info=Dialog.info=function(n,t,i,r,u){return Dialog.showInfo("info",n,t,i,r,u,!1)};epoint.dialog.info4workflow=Dialog.info=function(n,t,i,r,u){return Dialog.showInfo("info",n,t,i,r,u,!1,!1)};epoint.dialog.alert=Dialog.alert=function(n,t,i,r,u){return Dialog.showInfo("info",n,t,i,r,u)};epoint.dialog.error=Dialog.error=function(n,t,i,r,u){return Dialog.showInfo("errinfo",n,t,i,r,u)};epoint.dialog.success=Dialog.success=function(n,t,i,r,u){return Dialog.showInfo("successinfo",n,t,i,r,u)};epoint.dialog.warn=Dialog.warn=function(n,t,i,r,u){return Dialog.showInfo("warninfo",n,t,i,r,u)};epoint.dialog.confirm=Dialog.confirm=function(n,t,i,r,u,f,e,o){var u=u||560,f=f||250,s=new Dialog({Width:u,Height:f,Params:r,Resize:!1,Title:"信息确认"}),h;s.ShowMinButton=!1;s.ShowCloseButton=!1;s.ShowButtonRow=!0;s.CancelEvent=function(){s.close();i&&i(s.Params)};s.OKEvent=function(){s.close();t&&t(s.Params)};s.InnerHtml='<div class="icon question"><\/div><div class="message">'+n+"<\/div>";s.Top=($(document.body).height()-f)/2+$(document).scrollTop();s.Left=($(document.body).width()-u)/2+$(document).scrollLeft();e&&(s.OkButtonText=e);o&&(s.CancelButtonText=o);s.show();h=s.DialogDiv.find(".message");h.css("top",(120-h.height())/2);s.okButton.parent().css("textalign","center");try{s.okButton.focus()}catch(c){}return s};epoint.dialog.showTarget=Dialog.showTarget=function(n,t,i,r,u,f){var e,o;return t=t||"",u=u||450,f=f||230,e=new Dialog({Width:u,Height:f,Params:r,Resize:!1,Title:t}),e.ShowMinButton=!1,e.ShowCloseButton=!0,e.ShowButtonRow=!1,e.CancelEvent=function(){$("#"+n).html(e.InnerHtml);e.close();i&&i(e.Params)},e.InnerHtml=$("#"+n).html(),e.Top=($(document.body).height()-f)/2+$(document).scrollTop(),e.Left=($(document.body).width()-u)/2+$(document).scrollLeft(),e.show(),o=e.DialogDiv.find(".message"),o.css("top",(120-o.height())/2),$("#dialog").css("overflow","auto"),e};Dialog.open=function(n){var t=new Dialog(n);return t.show(),t}